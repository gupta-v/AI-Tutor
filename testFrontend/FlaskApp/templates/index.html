<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Tutor</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
  </head>
  <body>
    <div class="chat-container">
      <h2>ðŸŽ“ AI Tutor</h2>

      <!-- Status indicator for RAG system -->
      <div id="rag-status" class="status-indicator">
        <span class="status-dot inactive"></span>
        <span class="status-text">No PDFs loaded</span>
      </div>

      <div id="chat-box"></div>

      <!-- Listening Popup -->
      <div id="listening-popup" class="hidden">
        <div class="listening-box">
          <p id="listening-text">Listening...</p>
          <div class="wave-container">
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
          </div>
          <button id="stop-listening-btn" onclick="stopListening()">
            Stop
          </button>
        </div>
      </div>

      <!-- PDF Loading Progress -->
      <div id="loading-indicator" class="hidden">
        <div class="loading-box">
          <p id="loading-text">Loading PDFs...</p>
          <div class="spinner"></div>
        </div>
      </div>

      <div class="input-container">
        <textarea
          class="textbar"
          id="user-input"
          placeholder="Type your question..."
          rows="1"
          onkeydown="handleTextareaInput(event)"
        ></textarea>
        <div class="button-group">
          <button class="send-button" onclick="sendMessage()">Send</button>
          <button class="mic-button" onclick="toggleVoiceInput()">
            ðŸŽ¤ <span class="tooltip">Tap to speak/stop</span>
          </button>
        </div>

        <div class="pdf-controls">
          <input
            type="file"
            id="pdf-files"
            accept=".pdf"
            multiple
            style="display: none"
            onchange="handleFileUpload(this.files)"
          />
          <input
            type="file"
            id="pdf-folder"
            webkitdirectory
            directory
            multiple
            style="display: none"
            onchange="handleFolderUpload(this.files)"
          />

          <button
            class="doc-button"
            onclick="document.getElementById('pdf-files').click()"
          >
            ðŸ“„ <span class="tooltip">Add PDF Files</span>
          </button>

          <button class="stop-button" onclick="stopSpeech()">
            ðŸ›‘ <span class="tooltip">Stop speech</span>
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
